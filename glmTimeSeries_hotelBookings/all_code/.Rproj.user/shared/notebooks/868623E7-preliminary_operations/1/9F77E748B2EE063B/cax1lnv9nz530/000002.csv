"0","aggl.clust.c <- hclust(gower_dist, method = ""complete"") "
"0",""
"0",""
"0","library(fpc)"
"0","cstats.table <- function(dist, tree, k) {"
"0","  clust.assess <- c(""cluster.number"",""n"",""within.cluster.ss"",""average.within"",""average.between"",""wb.ratio"",""dunn2"",""avg.silwidth"")"
"0","  clust.size <- c(""cluster.size"")"
"0","  stats.names <- c()"
"0","  row.clust <- c()"
"0","  output.stats <- matrix(ncol = k, nrow = length(clust.assess))"
"0","  cluster.sizes <- matrix(ncol = k, nrow = k)"
"0","  for (i in c(1:k)) {"
"0","    row.clust[i] <- paste(""Cluster-"", i, "" size"")"
"0","  }"
"0","  for (i in c(2:k)) {"
"0","    stats.names[i] <- paste(""Test"", i - 1)"
"0","    "
"0","    for (j in seq_along(clust.assess)) {"
"0","      output.stats[j, i] <- unlist(cluster.stats(d = dist, clustering = cutree(tree, k = i))[clust.assess])[j]"
"0","      "
"0","    }"
"0","    "
"0","    for (d in 1:k) {"
"0","      cluster.sizes[d, i] <- unlist(cluster.stats(d = dist, clustering = cutree(tree, k = i))[clust.size])[d]"
"0","      dim(cluster.sizes[d, i]) <- c(length(cluster.sizes[i]), 1)"
"0","      cluster.sizes[d, i]"
"0","      "
"0","    }"
"0","  }"
"0","  output.stats.df <- data.frame(output.stats)"
"0","  cluster.sizes <- data.frame(cluster.sizes)"
"0","  cluster.sizes[is.na(cluster.sizes)] <- 0"
"0","  rows.all <- c(clust.assess, row.clust)"
"0","  "
"0","  # rownames(output.stats.df) <- clust.assess"
"0","  output <- rbind(output.stats.df, cluster.sizes)[ ,-1]"
"0","  colnames(output) <- stats.names[2:k]"
"0","  rownames(output) <- rows.all"
"0","  is.num <- sapply(output, is.numeric)"
"0","  output[is.num] <- lapply(output[is.num], round, 2)"
"0","  output"
"0","}"
